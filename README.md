# Flexberry.AsyncOpenXmlReports.Sample
## Система отчетов с использованием асинхронного сервиса Quartz.Net
- Приложение формирует отчеты по запросам пользователей. Для формирования отчетов используется Quartz.Net, благодаря чему отчеты формируются асинхронно и по расписанию. Присутствует возможность загрузки пользовательского шаблона, на основе которого будет строиться отчет.
- В приложении предусмотрена функция уведомления пользователя об окончании операции. Уведомление выполняется сразу двумя способами - через почту (MailKit) и всплывающее окно в интерфейсе клиента (SignalR).

## Стркутура проекта
![image](https://user-images.githubusercontent.com/29531380/235089220-c81c6cd3-63fd-43c3-864b-2f7ae56ec66d.png)

## Пример включает в себя следующие сервисы
- **App**: стандартные odata backend + ember-app приложения;
- **App-postgres-db**: база данных PostgreeSQL;
- **Keycloak**: сервис авторизации польователей;
- **Quartz**: сервис формирования отчетов.

## Сервис App
- Odata Backend;
- Ember-app Frontend;
- Создает SignalR соединения с пользователем через Web Socket для отправки уведомлений о формировании отчетов;
- Принимает запросы на формирование отчетов и отправляет их в сервис Quartz;
- Принимает ответы от сервиса Quartz о завершении формирования отчетов;
- Отправляет почтовые MailKit или SignalR уведомления о завершении формирования отчетов.

## Сервис App-postgres-db
- База данных приложения;
- База данных полномочий;
- База данных отчетов.

## Сервис Keycloak
- Сервис авторизации пользователей;
- Сервис ролей пользователей;
- Содержит и передает дополнительные данные пользователей, такие как email.

## Сервис Quartz
- Принимает запросы на формирование отчетов от сервиса App;
- Формирует задачи для Quartz.Net, в которых происходит формирование отчетов;
- Отправляет ответы о формировании отчетов в сервис App;
- Отчеты попадают в общее дисковое пространство докера: REPORTS.

## Запуск сервисов
- Используем рабочую папку src\Docker
- Собираем докер образы
```create-images.cmd```
- Запускаем сервисы
```start.cmd```
- Добавить в host имя сервиса keycloak
```127.0.0.1 keycloak```
- Приложение доступно по адресу 
```http://localhost```
- Консоль управления keycloak доступна по адресу
```http://keycloak:8080```
- Логин и пароль для доступа к сайту и keycloak
```admin\admin```
